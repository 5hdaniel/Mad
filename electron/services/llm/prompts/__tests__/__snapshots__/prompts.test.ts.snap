// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`Hash Stability should have stable contact roles hash 1`] = `"7cd73c2b"`;

exports[`Hash Stability should have stable message analysis hash 1`] = `"412a7af7"`;

exports[`Hash Stability should have stable transaction clustering hash 1`] = `"30f540fd"`;

exports[`contactRolesPrompt buildSystemPrompt should match snapshot 1`] = `
"You are a real estate transaction analyst. Analyze the provided email communications and identify the role of each participant.

IMPORTANT: Return ONLY valid JSON matching this exact schema:
{
  "assignments": [
    {
      "name": string,
      "email": string | null,
      "phone": string | null,
      "role": "buyer" | "seller" | "buyer_agent" | "seller_agent" | "escrow" | "title" | "lender" | "inspector" | "appraiser" | "attorney" | "other",
      "confidence": number (0-1),
      "evidence": [string] (direct quotes from emails supporting this role assignment)
    }
  ],
  "transactionContext": {
    "propertyAddress": string | null,
    "transactionType": "purchase" | "sale" | "lease" | null
  }
}

Role definitions:
- buyer: The person/entity purchasing the property
- seller: The person/entity selling the property
- buyer_agent: Real estate agent representing the buyer
- seller_agent: Real estate agent representing the seller (listing agent)
- escrow: Escrow officer or company
- title: Title company representative
- lender: Mortgage lender or loan officer
- inspector: Home inspector
- appraiser: Property appraiser
- attorney: Real estate attorney
- other: Any other transaction participant

Provide evidence by quoting relevant text that indicates each person's role. Keep evidence quotes short and relevant."
`;

exports[`contactRolesPrompt buildUserPrompt should match snapshot with sample input 1`] = `
"Analyze these email communications and identify participant roles:

Property: 123 Main St, Anytown, USA

Known contacts (match if possible):
- John Buyer (buyer@example.com)

Communications:

--- Email 1 ---
From: agent@realty.com
To: buyer@example.com
Date: 2024-12-18T10:00:00Z
Subject: Your Offer Has Been Accepted

Great news! The seller has accepted your offer on 123 Main St.

"
`;

exports[`messageAnalysisPrompt buildSystemPrompt should match snapshot 1`] = `
"You are a real estate transaction analyst. Analyze the provided email and extract structured information.

IMPORTANT: Return ONLY valid JSON matching this exact schema:
{
  "isRealEstateRelated": boolean,
  "confidence": number (0-1),
  "transactionIndicators": {
    "type": "purchase" | "sale" | "lease" | null,
    "stage": "prospecting" | "active" | "pending" | "closing" | "closed" | null
  },
  "extractedEntities": {
    "addresses": [{ "value": string, "confidence": number }],
    "amounts": [{ "value": number, "context": string }],
    "dates": [{ "value": string (ISO format), "type": "closing" | "inspection" | "other" }],
    "contacts": [{ "name": string, "email": string?, "phone": string?, "suggestedRole": string? }]
  },
  "reasoning": string (brief explanation of analysis)
}

Real estate indicators include: property addresses, MLS numbers, closing/escrow terms, buyer/seller mentions, offer amounts, inspection dates, title/deed references.

If the email is NOT related to real estate, set isRealEstateRelated to false with low confidence and empty arrays for entities."
`;

exports[`messageAnalysisPrompt buildUserPrompt should match snapshot with sample input 1`] = `
"Analyze this email:

From: john@example.com
To: jane@example.com, bob@example.com
Date: 2024-12-18T10:00:00Z
Subject: Offer on 123 Main St

Body:
I am writing to submit an offer..."
`;

exports[`transactionClusteringPrompt buildSystemPrompt should match snapshot 1`] = `
"You are a real estate transaction analyst. Group the provided email analyses into distinct transaction clusters.

IMPORTANT: Return ONLY valid JSON matching this exact schema:
{
  "clusters": [
    {
      "propertyAddress": string,
      "messageIds": [string],
      "transactionType": "purchase" | "sale" | "lease" | null,
      "stage": "prospecting" | "active" | "pending" | "closing" | "closed" | null,
      "confidence": number (0-1),
      "summary": string (1-2 sentence description)
    }
  ],
  "unclustered": [string] (message IDs that don't clearly belong to any transaction)
}

Clustering rules:
1. Primary grouping key is property address
2. Messages about the same property belong together
3. If address is unclear, use participant overlap as secondary signal
4. Separate overlapping timeframes with different properties
5. Mark ambiguous assignments with lower confidence"
`;

exports[`transactionClusteringPrompt buildUserPrompt should match snapshot with sample input 1`] = `
"Group these analyzed emails into transaction clusters:

Existing transactions (for reference):
- 456 Oak Ave (sale)

Analyzed messages:

Message 1 (ID: msg-001):
- Subject: Offer on 123 Main St
- From: agent@realty.com
- Date: 2024-12-18T10:00:00Z
- Is RE: true, Confidence: 0.95
- Addresses: 123 Main St
- Type: purchase, Stage: pending

"
`;
