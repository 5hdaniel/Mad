# EUM-012: Team Members Management UI

## Task Info
- **Task ID:** EUM-012
- **Phase:** 3 - Admin Portal
- **Dependencies:** EUM-010 (Phase 2 complete)
- **Can Start:** After Phase 2 merge
- **Parallel With:** EUM-011, EUM-013, EUM-014

## Goal

Create React components for managing team members including user list, invitations, role management, and bulk operations.

## Non-Goals

- ‚ùå Building backend services (handled in Phase 1)
- ‚ùå Implementing SCIM provisioning (handled in Phase 4)
- ‚ùå SSO configuration (handled in EUM-013)
- ‚ùå Audit log viewing (handled in EUM-014)
- ‚ùå Email invitation delivery (backend handles this)
- ‚ùå Custom role creation (fixed roles only)

## Deliverables

1. Team members list with search/filter
2. Invite member modal
3. Role assignment UI
4. Suspend/remove member actions
5. Bulk operations (CSV import)

## Component Structure

```
src/components/admin/
‚îú‚îÄ‚îÄ TeamMembers.tsx               # Main container
‚îú‚îÄ‚îÄ MembersList.tsx               # Paginated member list
‚îú‚îÄ‚îÄ MemberRow.tsx                 # Individual member row
‚îú‚îÄ‚îÄ InviteMemberModal.tsx         # Invite dialog
‚îú‚îÄ‚îÄ BulkInviteModal.tsx           # CSV bulk invite
‚îú‚îÄ‚îÄ MemberActionsMenu.tsx         # Dropdown actions
‚îî‚îÄ‚îÄ RoleSelector.tsx              # Role dropdown
```

## Key Features

1. **Members List**
   - Searchable/filterable table
   - Columns: Name, Email, Role, Status, Provisioning Source, Actions
   - Pagination for large teams
   - Sort by column

2. **Invite Flow**
   - Single email invite
   - Role selection (admin/member)
   - Bulk CSV import
   - Pending invitations view

3. **Member Actions**
   - Change role (admin ‚Üî member)
   - Suspend member
   - Reactivate member
   - Remove from organization

4. **Provisioning Indicators**
   - Manual (üë§)
   - SSO JIT (üîê)
   - SCIM (üîÑ)

## Example Component

```tsx
// src/components/admin/TeamMembers.tsx
export function TeamMembers() {
  const { orgId } = useParams<{ orgId: string }>();
  const [members, setMembers] = useState<OrganizationMember[]>([]);
  const [search, setSearch] = useState('');
  const [roleFilter, setRoleFilter] = useState<string>('all');
  const [showInviteModal, setShowInviteModal] = useState(false);

  return (
    <div className="space-y-4">
      <div className="flex justify-between items-center">
        <h2 className="text-xl font-semibold">Team Members</h2>
        <Button onClick={() => setShowInviteModal(true)}>
          Invite Member
        </Button>
      </div>

      <div className="flex gap-4">
        <SearchInput value={search} onChange={setSearch} />
        <RoleFilter value={roleFilter} onChange={setRoleFilter} />
      </div>

      <MembersList
        members={filteredMembers}
        onRoleChange={handleRoleChange}
        onSuspend={handleSuspend}
        onRemove={handleRemove}
      />

      <InviteMemberModal
        open={showInviteModal}
        onClose={() => setShowInviteModal(false)}
        orgId={orgId!}
        onInvited={loadMembers}
      />
    </div>
  );
}
```

## Files to Create

- `src/components/admin/TeamMembers.tsx`
- `src/components/admin/MembersList.tsx`
- `src/components/admin/MemberRow.tsx`
- `src/components/admin/InviteMemberModal.tsx`
- `src/components/admin/BulkInviteModal.tsx`
- `src/components/admin/MemberActionsMenu.tsx`
- `src/components/admin/__tests__/TeamMembers.test.tsx`

## Dos

- ‚úÖ Show provisioning source icons for transparency
- ‚úÖ Disable actions user cannot perform based on RBAC
- ‚úÖ Handle seat limit errors gracefully
- ‚úÖ Validate email format before invite
- ‚úÖ Show pending invitations separately

## Don'ts

- ‚ùå Don't allow removing the last owner
- ‚ùå Don't show role change option for owners
- ‚ùå Don't allow bulk invite beyond seat limit
- ‚ùå Don't expose internal IDs in UI

## Acceptance Criteria

- [ ] Members list loads and displays with pagination
- [ ] Search filters members by name/email
- [ ] Role filter works correctly
- [ ] Invite modal validates email and respects seat limits
- [ ] Role selection shows admin/member options only
- [ ] Bulk CSV import parses and validates emails
- [ ] Role change works (except for owners)
- [ ] Suspend/reactivate toggles member status
- [ ] Remove member shows confirmation and works
- [ ] Provisioning source icons display correctly (manual, SSO JIT, SCIM)
- [ ] Actions are disabled for operations user cannot perform
- [ ] Unit tests cover main interactions

## When to Stop and Ask

You MUST stop and ask the PM if:

1. **Bulk import format** - If CSV format for bulk import is unclear
2. **Seat limit UX** - If seat limit error handling needs special design
3. **Owner protection** - If owner operations have edge cases
4. **Provisioning badges** - If provisioning source display needs more detail
5. **Pending invitations** - If pending invite expiration/resend is needed
6. **Filter combinations** - If complex filter combinations are needed

Do NOT guess or make assumptions. Ask first.

## Integration Notes

### Dependencies
- **EUM-002**: Uses Organization Service for member CRUD
- **EUM-004**: Uses RBAC Service for permission-based actions

### For EUM-015 (Integration Task)
- Component must work within AdminLayout
- Must respond to route params (`orgId`)
- Must handle concurrent member updates

### CSV Bulk Import Format
```csv
email,role
user1@company.com,member
user2@company.com,admin
```

## PR Preparation Checklist

- [ ] All components implemented
- [ ] RBAC checked (only show actions user can perform)
- [ ] Unit tests written
- [ ] Bulk import handles errors gracefully
- [ ] Type check passes
- [ ] Lint check passes

## Work Summary

### Branch Name
```
[FILL IN YOUR BRANCH NAME HERE]
```

### Changes Made
```
[LIST CHANGES]
```

### Testing Done
```
[DESCRIBE TESTING]
```

### PR Link
```
[LINK TO PR]
```
