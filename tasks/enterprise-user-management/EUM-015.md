# EUM-015: Portal Integration & QA

## Task Info
- **Task ID:** EUM-015
- **Phase:** 3 - Admin Portal (MERGE TASK)
- **Dependencies:** EUM-011, EUM-012, EUM-013, EUM-014
- **Can Start:** After all Phase 3 parallel tasks complete
- **Blocks:** All Phase 4 tasks

## Goal

Integrate all admin portal components, set up routing, ensure consistent styling, and perform QA testing.

## Non-Goals

- ❌ Adding new admin features beyond EUM-011 through EUM-014
- ❌ Implementing SCIM UI (handled in Phase 4)
- ❌ Mobile-native features
- ❌ Offline functionality
- ❌ Performance optimization beyond basic responsiveness
- ❌ Multi-language/i18n support

## Deliverables

1. All portal components integrated
2. Navigation/routing configured
3. Permission-based UI visibility
4. Consistent styling throughout
5. Accessibility audit complete
6. QA testing complete

## Technical Requirements

### 1. Set Up Admin Routes

```tsx
// src/routes/adminRoutes.tsx
export const adminRoutes = [
  { path: '/org/:orgId/settings', component: OrganizationSettings },
  { path: '/org/:orgId/members', component: TeamMembers },
  { path: '/org/:orgId/sso', component: SSOConfiguration },
  { path: '/org/:orgId/audit', component: AuditLogs },
];
```

### 2. Create Admin Layout

```tsx
// src/components/admin/AdminLayout.tsx
export function AdminLayout() {
  const { orgId } = useParams();
  const { permissions } = useOrgPermissions(orgId);

  return (
    <div className="flex">
      <AdminSidebar permissions={permissions} />
      <main className="flex-1 p-6">
        <Outlet />
      </main>
    </div>
  );
}
```

### 3. Create Admin Sidebar

```tsx
// src/components/admin/AdminSidebar.tsx
export function AdminSidebar({ permissions }) {
  return (
    <nav className="w-64 border-r p-4">
      <NavLink to="settings">Organization</NavLink>
      <NavLink to="members">Team Members</NavLink>
      {permissions.includes('sso.view') && (
        <NavLink to="sso">SSO</NavLink>
      )}
      {permissions.includes('audit.view') && (
        <NavLink to="audit">Audit Logs</NavLink>
      )}
    </nav>
  );
}
```

### 4. Permission-Based UI

Components should:
- Hide features user can't access
- Disable buttons for actions user can't perform
- Show helpful messages instead of empty states

## QA Checklist

### Functionality
- [ ] All pages load without errors
- [ ] Navigation works between all sections
- [ ] All CRUD operations work
- [ ] Error handling shows user-friendly messages
- [ ] Loading states show appropriately

### Permissions
- [ ] Owner sees all features
- [ ] Admin sees appropriate features
- [ ] Member sees limited features
- [ ] Non-member is redirected

### Responsiveness
- [ ] Desktop (1920px) - Full layout
- [ ] Laptop (1366px) - Compact layout
- [ ] Tablet (768px) - Collapsible sidebar

### Accessibility
- [ ] Keyboard navigation works
- [ ] Screen reader friendly
- [ ] Color contrast meets WCAG AA
- [ ] Focus indicators visible

### Cross-browser
- [ ] Chrome
- [ ] Firefox
- [ ] Safari
- [ ] Edge

## Files to Create

- `src/routes/adminRoutes.tsx`
- `src/components/admin/AdminLayout.tsx`
- `src/components/admin/AdminSidebar.tsx`
- `src/hooks/useOrgPermissions.ts`

## Files to Modify

- `src/App.tsx` - Add admin routes
- Various components - Ensure consistent styling

## Dos

- ✅ Test all three role types (owner, admin, member)
- ✅ Verify keyboard navigation throughout
- ✅ Test on multiple screen sizes
- ✅ Ensure consistent error handling patterns
- ✅ Verify all async operations have loading states

## Don'ts

- ❌ Don't merge if any accessibility issues remain
- ❌ Don't skip permission-based visibility testing
- ❌ Don't leave inconsistent styling
- ❌ Don't ignore browser-specific issues

## Acceptance Criteria

- [ ] All Phase 3 task branches merged without conflicts
- [ ] Admin routes configured and working
- [ ] AdminLayout wraps all admin pages
- [ ] Sidebar navigation shows permission-appropriate links
- [ ] Organization Settings page works
- [ ] Team Members page works
- [ ] SSO Configuration page works
- [ ] Audit Logs page works
- [ ] Owner sees all features
- [ ] Admin sees appropriate features (not delete, ownership)
- [ ] Member sees limited features (view only)
- [ ] Non-member is redirected appropriately
- [ ] Responsive at desktop, laptop, tablet breakpoints
- [ ] Keyboard navigation works throughout
- [ ] Color contrast meets WCAG AA
- [ ] Type check passes: `npm run type-check`
- [ ] Lint check passes: `npm run lint`

## When to Stop and Ask

You MUST stop and ask the PM if:

1. **Merge conflicts** - If Phase 3 branches have significant conflicts
2. **Styling inconsistencies** - If components use different patterns
3. **Accessibility blockers** - If WCAG compliance requires major changes
4. **Permission edge cases** - If permission-based UI has unclear scenarios
5. **Cross-browser issues** - If browser-specific bugs are found
6. **Performance issues** - If portal feels sluggish on any page

Do NOT guess or make assumptions. Ask first.

## Integration Notes

### This Task Depends On
- **EUM-011**: Organization Settings UI
- **EUM-012**: Team Members Management UI
- **EUM-013**: SSO Configuration Wizard
- **EUM-014**: Audit Logs Viewer

### This Task Blocks
- **All Phase 4 tasks**: SCIM and provisioning UI depends on portal foundation
- Phase 4 cannot start until this task is complete and merged

### Integration Points to Verify
1. All components use shared hooks (useOrgPermissions, etc.)
2. Toast notifications consistent across all pages
3. Confirmation modals use same pattern
4. Loading spinners match app style
5. Error states handled consistently
6. Navigation highlights current section

### Permission Hook Usage
```tsx
const { permissions, isLoading } = useOrgPermissions(orgId);
// permissions: Permission[] from EUM-004
// Use to show/hide features and disable buttons
```

## PR Preparation Checklist

- [ ] All Phase 3 tasks merged
- [ ] Routing works
- [ ] Permission-based UI works
- [ ] QA checklist complete
- [ ] Accessibility audit passed
- [ ] Type check passes
- [ ] Lint check passes

## Work Summary

### Branch Name
```
[FILL IN YOUR BRANCH NAME HERE]
```

### Changes Made
```
[LIST CHANGES]
```

### Testing Done
```
[DESCRIBE QA TESTING]
```

### PR Link
```
[LINK TO PR]
```
