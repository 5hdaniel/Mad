# EUM-011: Organization Settings UI

## Task Info
- **Task ID:** EUM-011
- **Phase:** 3 - Admin Portal
- **Dependencies:** EUM-010 (Phase 2 complete)
- **Can Start:** After Phase 2 merge
- **Parallel With:** EUM-012, EUM-013, EUM-014

## Goal

Create React components for organization settings management including profile, branding, domains, and danger zone operations.

## Non-Goals

- ❌ Building backend services (handled in Phase 1)
- ❌ Implementing SSO configuration (handled in EUM-013)
- ❌ Managing team members (handled in EUM-012)
- ❌ Viewing audit logs (handled in EUM-014)
- ❌ Billing or subscription management
- ❌ Logo storage/CDN implementation (placeholder acceptable)

## Deliverables

1. Organization settings page component
2. Profile editing (name, slug, logo)
3. Domain management
4. License information display
5. Danger zone (delete organization)

## Technical Requirements

### Component Structure

```
src/components/admin/
├── OrganizationSettings.tsx      # Main settings container
├── OrgProfileSection.tsx         # Name, slug, logo
├── OrgDomainsSection.tsx         # Domain management
├── OrgLicenseSection.tsx         # License info display
└── OrgDangerZone.tsx             # Delete organization
```

### Key Features

1. **Profile Section**
   - Edit organization name
   - Edit slug (with validation)
   - Upload/change logo
   - Save changes

2. **Domains Section**
   - List verified domains
   - Add new domain
   - Remove domain
   - Domain verification status

3. **License Section**
   - Display license type (team/enterprise)
   - Show seat usage (X of Y used)
   - Upgrade prompts

4. **Danger Zone**
   - Delete organization button
   - Confirmation modal
   - Transfer ownership option

### Example Component

```tsx
// src/components/admin/OrganizationSettings.tsx
import React, { useState, useEffect } from 'react';
import { useParams } from 'react-router-dom';
import { OrgProfileSection } from './OrgProfileSection';
import { OrgDomainsSection } from './OrgDomainsSection';
import { OrgLicenseSection } from './OrgLicenseSection';
import { OrgDangerZone } from './OrgDangerZone';

export function OrganizationSettings() {
  const { orgId } = useParams<{ orgId: string }>();
  const [org, setOrg] = useState<Organization | null>(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadOrganization();
  }, [orgId]);

  const loadOrganization = async () => {
    const result = await window.api.org.get(orgId!);
    if (result.success) {
      setOrg(result.data);
    }
    setLoading(false);
  };

  if (loading) return <LoadingSpinner />;
  if (!org) return <NotFound />;

  return (
    <div className="max-w-4xl mx-auto p-6 space-y-8">
      <h1 className="text-2xl font-bold">Organization Settings</h1>

      <OrgProfileSection org={org} onUpdate={loadOrganization} />
      <OrgDomainsSection org={org} onUpdate={loadOrganization} />
      <OrgLicenseSection org={org} />
      <OrgDangerZone org={org} />
    </div>
  );
}
```

## Files to Create

- `src/components/admin/OrganizationSettings.tsx`
- `src/components/admin/OrgProfileSection.tsx`
- `src/components/admin/OrgDomainsSection.tsx`
- `src/components/admin/OrgLicenseSection.tsx`
- `src/components/admin/OrgDangerZone.tsx`
- `src/components/admin/__tests__/OrganizationSettings.test.tsx`

## UI/UX Requirements

- Use existing Tailwind design system
- Loading states for all async operations
- Error handling with toast notifications
- Confirmation dialogs for destructive actions
- Responsive design

## Dos

- ✅ Use existing design system and components
- ✅ Show loading states for all async operations
- ✅ Disable buttons during form submission
- ✅ Validate inputs before submission
- ✅ Require confirmation for destructive actions

## Don'ts

- ❌ Don't implement custom styling outside design system
- ❌ Don't allow slug changes without validation
- ❌ Don't show delete option to non-owners
- ❌ Don't silently fail on errors

## Acceptance Criteria

- [ ] Organization profile loads and displays correctly
- [ ] Name and slug can be edited and saved
- [ ] Logo can be uploaded/changed
- [ ] Domains list displays with add/remove functionality
- [ ] License info shows type and seat usage
- [ ] Delete organization requires confirmation modal
- [ ] Ownership transfer works with user selection
- [ ] All actions respect RBAC permissions
- [ ] Loading states appear during operations
- [ ] Error messages display on failures
- [ ] Unit tests cover main component interactions

## When to Stop and Ask

You MUST stop and ask the PM if:

1. **Design system gaps** - If existing components don't support needed functionality
2. **Logo upload** - If file upload/storage mechanism is unclear
3. **Slug validation** - If slug uniqueness checking needs special handling
4. **Domain verification** - If domain verification flow UI is unclear
5. **Delete flow** - If organization deletion has dependencies that need special handling
6. **Permission UI** - If RBAC rules for UI visibility are unclear

Do NOT guess or make assumptions. Ask first.

## Integration Notes

### Dependencies
- **EUM-002**: Uses Organization Service via IPC for CRUD operations
- **EUM-004**: Uses RBAC Service for permission-based UI visibility

### For EUM-015 (Integration Task)
- Component must work within AdminLayout
- Must respond to route params (`orgId`)
- Must refresh data after mutations

### Shared Concerns
- Use consistent toast notification patterns
- Use shared confirmation modal component
- Loading spinners should match app style

## PR Preparation Checklist

- [ ] All components implemented
- [ ] Unit tests written
- [ ] Responsive design verified
- [ ] Accessibility checked
- [ ] Type check passes
- [ ] Lint check passes

## Work Summary

### Branch Name
```
[FILL IN YOUR BRANCH NAME HERE]
```

### Changes Made
```
[LIST CHANGES]
```

### Testing Done
```
[DESCRIBE TESTING]
```

### PR Link
```
[LINK TO PR]
```
