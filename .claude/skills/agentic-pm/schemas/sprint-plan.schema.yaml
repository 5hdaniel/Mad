# Sprint Plan Schema
# Used for machine-readable sprint plan outputs

sprint_plan:
  type: object
  required:
    - name
    - goal
    - in_scope
    - phases
    - merge_plan
    - testing_plan
  properties:
    name:
      type: string
      description: Sprint identifier

    goal:
      type: string
      description: Sprint goal statement

    in_scope:
      type: array
      items:
        type: object
        properties:
          id:
            type: string
          title:
            type: string
          rationale:
            type: string

    out_of_scope:
      type: array
      items:
        type: object
        properties:
          id:
            type: string
          description:
            type: string
          reason:
            type: string

    backlog:
      type: array
      items:
        type: object
        required:
          - id
          - title
          - priority
        properties:
          id:
            type: string
          title:
            type: string
          priority:
            type: integer
          rationale:
            type: string
          dependencies:
            type: array
            items:
              type: string
          conflicts:
            type: array
            items:
              type: string

    phases:
      type: array
      items:
        type: object
        required:
          - number
          - name
          - tasks
          - integration_checkpoint
        properties:
          number:
            type: integer
          name:
            type: string
          tasks:
            type: array
            items:
              type: object
              properties:
                id:
                  type: string
                parallel:
                  type: boolean
                depends_on:
                  type: array
                  items:
                    type: string
          integration_checkpoint:
            type: object
            properties:
              target_branch:
                type: string
              ci_gates:
                type: array
                items:
                  type: string

    merge_plan:
      type: object
      properties:
        main_branch:
          type: string
        feature_branch_format:
          type: string
        integration_branches:
          type: array
          items:
            type: string
        merge_order:
          type: array
          items:
            type: object
            properties:
              from:
                type: string
              to:
                type: string
              order:
                type: integer

    testing_plan:
      type: object
      required:
        - ci_gates
      properties:
        unit_tests:
          type: object
          properties:
            new_tests:
              type: array
              items:
                type: string
            updated_tests:
              type: array
              items:
                type: string
        coverage:
          type: object
          properties:
            rule:
              type: string
            target:
              type: string
        integration_tests:
          type: array
          items:
            type: string
        ci_gates:
          type: array
          items:
            type: string

    risks:
      type: array
      items:
        type: object
        properties:
          id:
            type: string
          title:
            type: string
          likelihood:
            type: string
            enum: [low, medium, high]
          impact:
            type: string
            enum: [low, medium, high]
          mitigation:
            type: string

    decisions:
      type: array
      items:
        type: object
        properties:
          id:
            type: integer
          title:
            type: string
          date:
            type: string
            format: date
          decision:
            type: string
          rationale:
            type: string
